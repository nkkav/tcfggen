<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.11: http://docutils.sourceforge.net/" />
<title>tcfggen user manual</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id$
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="tcfggen-user-manual">
<h1 class="title">tcfggen user manual</h1>

<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<tbody valign="top">
<tr><td><strong>Title</strong></td>
<td>tcfggen (Task control flow graph extraction MachSUIF
pass)</td>
</tr>
<tr><td><strong>Author</strong></td>
<td>Nikolaos Kavvadias 2006, 2007, 2008, 2009, 2010, 2011,
2012, 2013, 2014</td>
</tr>
<tr><td><strong>Contact</strong></td>
<td><a class="reference external" href="mailto:nikos&#64;nkavvadias.com">nikos&#64;nkavvadias.com</a></td>
</tr>
<tr><td><strong>Website</strong></td>
<td><a class="reference external" href="http://www.nkavvadias.com">http://www.nkavvadias.com</a></td>
</tr>
<tr><td><strong>Release Date</strong></td>
<td>14 October 2014</td>
</tr>
<tr><td><strong>Version</strong></td>
<td>1.1.0</td>
</tr>
<tr><td><strong>Rev. history</strong></td>
<td>&nbsp;</td>
</tr>
<tr><td><strong>v1.1.0</strong></td>
<td><p class="first">2014-10-14</p>
<p class="last">Updated header comments in all source files. Added File
Listing section in README; added AUTHORS. Updated for
Github.</p>
</td>
</tr>
<tr><td><strong>v1.0.0</strong></td>
<td><p class="first">2014-02-24</p>
<p class="last">Changed documentation format to RestructuredText. Added
ChangeLog in separate file.</p>
</td>
</tr>
<tr><td><strong>v0.2.0</strong></td>
<td><p class="first">2006-06-27</p>
<p class="last">Fixed problem with parsing input arguments. All options:
&quot;-lut&quot;,&quot;-vcg&quot;,&quot;-fsm&quot;,&quot;-cac&quot; should work now.</p>
</td>
</tr>
<tr><td><strong>v0.1.0</strong></td>
<td><p class="first">2006-06-07</p>
<p class="last">Initial release. Code clean-up, added code generation
options.</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="introduction">
<h1>1. Introduction</h1>
<p><tt class="docutils literal">tcfggen</tt> is an analysis pass built to be used with the SUIF2/MachSUIF2
compiler infrastructure. <tt class="docutils literal">tcfggen</tt> performs (natural) loop analysis in order
tomap the control flow of a given optimization unit (i.e. a procedure in the
input program) to its task control flow graph (TCFG). It is also used to pass
the static information for the loops in the given procedure to the subsequent
stage(s) in the form of pseudo-instructions. These pseudo-instructions pass
information regarding:</p>
<ol class="loweralpha simple">
<li>the task transitions</li>
<li>the points for task entry and task exit</li>
<li>the loop parameters (loop bounds and stride) and the basic induction register</li>
<li>which instructions should be removed for ZOLC execution</li>
</ol>
<p>This pass works for the SUIFrm instruction set and has been tested with MachSUIF
2.02.07.15.</p>
</div>
<div class="section" id="file-listing">
<h1>2. File listing</h1>
<p>The <tt class="docutils literal">tcfggen</tt> distribution includes the following files:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr><td>/tcfggen</td>
<td>Top-level directory</td>
</tr>
<tr><td>AUTHORS</td>
<td>List of <tt class="docutils literal">tcfggen</tt> authors.</td>
</tr>
<tr><td>LICENSE</td>
<td>The modified BSD license governs <tt class="docutils literal">tcfggen</tt>.</td>
</tr>
<tr><td>README.html</td>
<td>HTML version of README.</td>
</tr>
<tr><td>README.pdf</td>
<td>PDF version of README.</td>
</tr>
<tr><td>README.rst</td>
<td>This file.</td>
</tr>
<tr><td>VERSION</td>
<td>Current version of the project sources.</td>
</tr>
<tr><td>lcugen.cpp</td>
<td>Originally part of the loop count unit generator tool
(<tt class="docutils literal">lcugen</tt>) it used here for making a single pass on
the natural loop analysis results in order to assign
proper addresses to the data processing tasks (DPTs)
of the algorithm under analysis.</td>
</tr>
<tr><td>lcugen.h</td>
<td>C++ header file containing declarations and
prototypes for the above.</td>
</tr>
<tr><td>rst2docs.sh</td>
<td>Bash script for generating the HTML and PDF versions
of the documentation (README).</td>
</tr>
<tr><td>tcfggen.cpp</td>
<td>Implementation of the <tt class="docutils literal">tcfggen</tt> analysis pass.</td>
</tr>
<tr><td>tcfggen.h</td>
<td>C++ header file containing declarations and
prototypes for the above.</td>
</tr>
<tr><td>suif_main.cpp</td>
<td>Entry point for building the standalone program
<tt class="docutils literal">do_tcfggen</tt> that implements the pass.</td>
</tr>
<tr><td>suif_pass.cpp</td>
<td>Define the SUIF pass built as the dynamically
loadable library <tt class="docutils literal">libtcfggen.so</tt>.</td>
</tr>
<tr><td>suif_main.h</td>
<td>C++ header file for the above.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="technical-information">
<h1>3. Technical information</h1>
<p>This pass uses the <tt class="docutils literal">machine</tt>, <tt class="docutils literal">cfg</tt> and <tt class="docutils literal">cfa</tt> libraries of MachSUIF. It
also depends on the <tt class="docutils literal">suifrm</tt> backend. It first generates the natural
<tt class="docutils literal">loopanalysis</tt> report for the procedure. If formatted for text output, this
information would be as follows:</p>
<pre class="literal-block">
Loop info:
  node depth begin end exit
   int: int   Y/N  Y/N  Y/N
   ...................................
</pre>
<p>where:</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-n<var>ode</var></span></kbd></td>
<td>the number of the corresponding basic block (integer)</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-d<var>epth</var></span></kbd></td>
<td>the loop nesting depth (integer)</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-b<var>egin</var></span></kbd></td>
<td>a boolean flag to report if a loop begins at the specified node</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-e<var>nd</var></span></kbd></td>
<td>a boolean flag to report if a loop ends at the specified node</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-e<var>xit</var></span></kbd></td>
<td>a boolean flag to report if an exit from the loop is possible from that node.</td></tr>
</tbody>
</table>
<p>Based on the loop analysis results, four different types of pseudo-instructions
are generated. Their assembly formats are shown below:</p>
<pre class="literal-block">
ldst     &lt;current-taskid&gt;, &lt;next-taskid&gt;, &lt;next-ttsel&gt;, &lt;next-loop_a&gt;
dpti     &lt;id&gt;, &lt;first-bb&gt;, &lt;last-bb&gt;
loop     &lt;loop_a&gt;, &lt;rindex&gt;, &lt;initial&gt;, &lt;step&gt;, &lt;final&gt;
overhead &lt;state&gt;
</pre>
<p>An LDST instruction incorporates all the information needed for creating a task
selection LUT entry: for a given task encoding (<tt class="docutils literal"><span class="pre">current-taskid</span></tt>), the
succeeding task (<tt class="docutils literal"><span class="pre">next-taskid</span></tt>), its type (<tt class="docutils literal"><span class="pre">next-ttsel</span></tt>) and loop address
(<tt class="docutils literal"><span class="pre">next-loop_a</span></tt>) are given. These pseudos are attached to the last assembly
instruction in the task.</p>
<p>DPTI instructions denote the first (<tt class="docutils literal"><span class="pre">first-bb</span></tt>) and last basic block
(<tt class="docutils literal"><span class="pre">last-bb</span></tt>) of a task (its enumeration given by <tt class="docutils literal">id</tt>). This pseudo is
attached to the first instruction of this data-processing task.</p>
<p>A LOOP provides a given loop address (<tt class="docutils literal">loop_a</tt>), the actual loop index
register (<tt class="docutils literal">rindex</tt>) and the loop parameters (<tt class="docutils literal">initial</tt>, <tt class="docutils literal">step</tt>,
<tt class="docutils literal">final</tt>). This pseudo is attached to the last instruction in the basic block
(typically a BLT = <em>branch if less than</em>).</p>
<p>An OVERHEAD marks its following non-pseudo instruction whether it must be kept
(<tt class="docutils literal">state=0</tt> which is the default), replaced by a no-operation (<tt class="docutils literal">state=1</tt>),
or entirely removed (<tt class="docutils literal">state=2</tt>). These pseudos are attached to the specific
instructions.</p>
</div>
<div class="section" id="installation">
<h1>4. Installation</h1>
<p>Unpack the <tt class="docutils literal">tcfggen</tt> archive wherever you like, e.g. in
<tt class="docutils literal">$MACHSUIFHOME/cfa/tcfggen</tt>.
You don't need to modify anything in the Makefile, if you have a working
MachSUIF 2 installation.</p>
<p>The program binary (<tt class="docutils literal">do_tcfggen</tt>) will be installed at $NCIHOME/bin and the
shared library (<tt class="docutils literal">libtcfggen.so</tt>) at <tt class="docutils literal">$NCIHOME/solib</tt>, where NCIHOME is the
SUIF 2 top-level directory.</p>
</div>
<div class="section" id="usage-details">
<h1>5. Usage details</h1>
<p>The pass accepts an input file in CFG form to operate. The output file is a
SUIF CFG containing the input CFG with the generated pseudo-instructions.</p>
<p>Usage synopsys:</p>
<div class="line-block">
<div class="line"><tt class="docutils literal">$ do_tcfggen [options] input.cfg output.cfg</tt></div>
</div>
<p>where options can be one (or more) of the following:</p>
<dl class="docutils">
<dt><strong>-proc &lt;opt-unit&gt;</strong></dt>
<dd>specify the name of the procedure to perform TCFG construction and generation
of pseudo-instructions</dd>
<dt><strong>-lut</strong></dt>
<dd>generate the VHDL source for the task selection LUT</dd>
<dt><strong>-vcg</strong></dt>
<dd>visualize the TCFG in VCG format</dd>
<dt><strong>-fsm</strong></dt>
<dd>generate the VHDL source for an FSM implementation of the task selection unit</dd>
<dt><strong>-cac</strong></dt>
<dd>generate C simulation code for the initialization of the task selection unit.</dd>
</dl>
</div>
<div class="section" id="known-limitations">
<h1>6. Known limitations</h1>
<ol class="arabic simple">
<li>MachSUIF (2.02.07.15) only includes natural loop analysis.</li>
<li>Currently, there is support for static loops only.</li>
<li>An 'optimization unit' can only be a single function or procedure.</li>
</ol>
</div>
</div>
</body>
</html>
